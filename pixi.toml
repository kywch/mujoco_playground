[project]
channels = ["nvidia", "conda-forge"]
name = "mujoco_playground"
platforms = ["linux-64"]

[system-requirements]
cuda = "12"

[activation.env]
CUDA_HOME = "$CONDA_PREFIX"
JAX_TRACEBACK_FILTERING = "off"
JAX_DEFAULT_MATMUL_PRECISION = "highest"
XLA_PYTHON_CLIENT_MEM_FRACTION = "0.3"

[dependencies]
python = ">=3.12,<3.13"
pip = "*"
setuptools = "*"
wheel = "*"
git = "*"

# For jax/rsl-rl trainers
mediapy = ">=1.2.4,<2"
wandb = ">=0.21.0,<0.22"
tensorboard = ">=2.20.0,<3"

[pypi-dependencies]
torch = { index = "https://download.pytorch.org/whl/cu121" }
torchvision = { index = "https://download.pytorch.org/whl/cu121" }
torchaudio = { index = "https://download.pytorch.org/whl/cu121" }
jax = { extras = ["cuda12"] }

rsl-rl-lib = "<3"

# playground = { path = ".", editable = true }
playground = "*"

[tasks]
test_torch = "python -c 'import torch; print(torch.cuda.is_available())'"
test_jax = "python -c 'import jax; print(jax.devices())'"
